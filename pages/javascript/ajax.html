<!--
title: HTML <u>still</u> ROCKS!
-->
<h3>AJAX原理及实践</h3>
<p>
ajax的原理
XMLHttpRequest是ajax的核心机制，它是在IE5中首先引入的，是一种支持异步请求的技术。简单的说，也就是javascript可以及时向服务器提出请求和处理响应，而不阻塞用户。达到无刷新的效果。
所以我们先从XMLHttpRequest讲起，来看看它的工作原理。
首先，我们先来看看XMLHttpRequest这个对象的属性。
它的属性有：
onreadystatechange  每次状态改变所触发事件的事件处理程序。
responseText     从服务器进程返回数据的字符串形式。
responseXML   从服务器进程返回的DOM兼容的文档数据对象。
status                 从服务器返回的数字代码，比如常见的404（未找到）和200（已就绪）
status Text         伴随状态码的字符串信息
readyState         对象状态值，0—未初始化 1—正在加载  2—加载完毕 3—交互 4—完成。

</p>
<h4>main.js</h4>
<pre>
    <code>
        var $ajax = document.querySelector("#ajax")
        var xhr;
        if(window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xhr = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xhr = new ActiveXObject('Microsoft.XMLHTTP');
        }
        
        /**
        * 这是具体的参数描述：
        * open(method,url,async)：规定请求的类型、URL 以及是否异步处理请求。
        * method：请求的类型；GET 或 POST
        * url：文件在服务器上的位置
        * async：true（异步）或 false（同步）
        */
        xhr.open('GET', 'test.json', false);
        xhr.onreadystatechange = function() {
            // 0: 请求未初始化
            // 1: 服务器连接已建立
            // 2: 请求已接收
            // 3: 请求处理中
            // 4: 请求已完成，且响应已就绪
            if(xhr.readyState == 4 && xhr.status == 200) {
                console.log(xhr.responseText);
                document.querySelector('.test').innerHTML = xhr.responseText;
            }
        }
        /**
        send(string): 将请求发送到服务器。
        string：仅用于 POST 请求
        */
        xhr.send();
    </code>
</pre>

<h4>index.html</h4>
<pre>
    <xmp>
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta http-equiv="X-UA-Compatible" content="ie=edge">
            <title>Document</title>
        </head>
        <body>
            <h3>ajax原理及实践</h3>
            <div id="ajax">test</div>
            <div class="test"></div>
            <script src="js/main.js"></script>
        </body>
        </html>
    </xmp>
</pre>

<h4>test.json</h4>
<pre>
    <code>
        {
            "test": "Hello Ajax."
        }
    </code>
</pre>